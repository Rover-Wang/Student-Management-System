{% extends 'base.html' %}
{% block title %}学习证明管理{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="row">
        <div class="col-12">
            <h3 class="mb-4">
                <i class="bi bi-file-earmark-badge me-2 text-primary"></i>学习证明管理
            </h3>
            
            <div class="card shadow-sm mb-4">
                <div class="card-header bg-light fw-bold">
                    上传新的证明文件
                </div>
                <form action="{{ url_for('student.upload_certificate') }}" method="POST" enctype="multipart/form-data" class="card-body">
                    <div class="mb-3">
                        <label for="certFile" class="form-label">选择文件 (例如：证书图片, PDF)</label>
                        <input class="form-control" type="file" id="certFile" name="cert_file" required>
                    </div>
                    <div class="mb-3">
                        <label for="certDescription" class="form-label">描述</label>
                        <input type="text" class="form-control" id="certDescription" name="description" placeholder="例如：通过Python中级考试" required>
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="bi bi-upload me-2"></i>上传证明
                    </button>
                </form>
            </div>

            <h4 class="mb-3">我的已上传证明 (共 {{ certificates|length }} 个)</h4>
            {% if certificates %}
            <div class="list-group shadow-sm">
                {% for cert in certificates %}
                <div class="list-group-item d-flex justify-content-between align-items-center py-3">
                    <div class="d-flex align-items-center">
                        <div class="me-3">
                            <i class="bi bi-file-earmark-check text-success fs-4"></i>
                        </div>
                        <div>
                            <div class="fw-bold">{{ cert.description or '未命名证明' }}</div>
                            <small class="text-muted">
                                上传日期: {{ cert.upload_time.strftime('%Y-%m-%d %H:%M') }}
                                {% if cert.status == 0 %}
                                    <span class="badge bg-warning text-dark ms-2">待审核</span>
                                {% elif cert.status == 1 %}
                                    <span class="badge bg-success ms-2">审核通过</span>
                                {% elif cert.status == 2 %}
                                    <span class="badge bg-danger ms-2">已驳回</span>
                                {% endif %}
                            </small>
                        </div>
                    </div>

                    <form action="{{ url_for('student.delete_certificate', cert_id=cert.id) }}" method="POST" onsubmit="return confirm('确定要删除这条证明记录吗？此操作无法撤销。');">
                        <button type="submit" class="btn btn-outline-danger btn-sm" title="删除记录">
                            <i class="bi bi-trash"></i>
                        </button>
                    </form>
                </div>
                {% endfor %}
            </div>
            {% else %}
            <div class="alert alert-info border-0 shadow-sm" role="alert">
                <i class="bi bi-info-circle me-2"></i>您还没有上传任何学习证明。
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}